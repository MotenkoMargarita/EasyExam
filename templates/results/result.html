{% from 'macro/macro.html' import headBegin with context %}
{% from 'macro/macro.html' import headEnd with context %}
{% from 'macro/macro.html' import nav with context %}
{% from 'macro/macro.html' import footer with context %}
{% from 'macro/macro.html' import end with context %}
{% from 'macro/macro.html' import mathjaxToShow with context %}

{{ headBegin() }}
<script src="/static/js/test.js"></script>

<title>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ï–ì–≠</title>
{{ mathjaxToShow() }}
{{ headEnd() }}

{{ nav() }}

<div class="container">
    {% for message in get_flashed_messages() %}
        <div class="alert alert-warning mt-3" role="alert">
            {{ message }}
        </div>
    {% endfor %}

    <div class="mt-3 mb-3 d-flex justify-content-between">
        <h2 style="color: maroon"><font face="Impact">üìñ {{ subject.name }} : üìù {{ test_type.name }}</font></h2>
        <h2>
            <div><font size="4" face="Impact" color="#a0522d">‚åõ –ü–æ—Ç—Ä–∞—á–µ–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ {{ result.time_spent }}</font></div>
        </h2>
    </div>

    <div class="mt-3 mb-3 d-flex justify-content-between">
        {% if result.result_first_mark %}
            <h2><font size="5"> üèÜ –í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <font color="#dc143c">{{ result.result_first_mark }}</font> –ø–µ—Ä–≤–∏—á–Ω—ã—Ö –±–∞–ª–ª–∞</font></h2>
        {% else %}
            <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ –ø–µ—Ä–≤—É—é —á–∞—Å—Ç—å: {{ result.first_part_first_mark }} –ø–µ—Ä–≤–∏—á–Ω—ã—Ö –±–∞–ª–ª–∞.
                –ò–ª–∏ {{ result.first_part_test_mark }} —Ç–µ—Å—Ç–æ–≤—ã—Ö</h2>
        {% endif %}
    </div>

    {% if result.teacher_file %}
        <div class="d-grid gap-3  mb-3">
            <a href="{{ url_for('download_solution', filename=result.teacher_file) }}" target="_blank"
               class="btn btn-warning">üì© –°–∫–∞—á–∞—Ç—å –∑–∞–º–µ—Ç–∫–∏ —É—á–∏—Ç–µ–ª—è</a>
        </div>
    {% else %}
        <h5 class="text-center mb-3" style="color: maroon">üö´ –£—á–∏—Ç–µ–ª—å –Ω–µ –ø—Ä–∏–ª–æ–∂–∏–ª –∑–∞–º–µ—Ç–∫–∏</h5>
    {% endif %}

    {% if result.solution_file %}
        <div class="d-grid gap-3  mb-3">
            <a href="{{ url_for('download_solution', filename=result.solution_file) }}" target="_blank"
               class="btn btn-warning">üì© –°–∫–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</a>
        </div>
    {% else %}
        <div class="d-grid gap-3  mb-3">
            <h5 class="text-center mb-3">‚ùå –ù–µ—Ç —Ñ–∞–π–ª–∞ —Å —Ä–µ—à–µ–Ω–∏–µ–º</h5>
        </div>
    {% endif %}


    {% for question in test.questions | sort(attribute='number') %}
        {% if question_number_question_info[question.number].questionType_id == 1 %}
            <!-- –ü–µ—Ä–≤–∞—è —á–∞—Å—Ç—å -->
            {% if question_id_answer[question.id] == question.answer %}
                <div class="card border-success mb-3">
            {% else %}
                <div class="card border-danger mb-3">
            {% endif %}
        <h5 class="card-header">
            {% for subject in subjects %}
                {% if question.subject_id == subject.id %}
                    {{ subject.name }}.
                {% endif %}
            {% endfor %}
            <font  color="maroon"> ‚úç –ó–∞–¥–∞–Ω–∏–µ ‚Ññ
                {{ question.number }}</font>
        </h5>
        <div class="card-body">
            {#                <div>#}
            <div class="mb-3">
                <label class="form-label"><font size="3"  color="maroon">–¢–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–∏—è:</font></label>
                <div class="spaces" id="textTextAreaResult{{ question.id }}">
                    <font size="5" face="Arial">  {{ question.text }}</font>
                </div>
            </div>
            <div class="mb-3">
                {% for image in question.images %}
                    <img src="{{ url_for('static', filename= "image/uploads/" + image.source) }}"
                         class="rounded mx-auto d-block mb-3" id="questionImage1"
                         style="max-width: 100%; max-height: 300px; min-height: 200px;">
                {% endfor %}
            </div>

            {% if question_id_answer[question.id] == question.answer %}
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">–û—Ç–≤–µ—Ç:</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control-plaintext"
                               name="question{{ question.id }}"
                               value="{{ question_id_answer[question.id] }}" disabled>
                    </div>
                </div>
            {% else %}
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">style="color: crimson"><font size="4" face="Arial Black"> ‚ùå –í–∞—à –æ—Ç–≤–µ—Ç: </font></label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control-plaintext"
                               name="question{{ question.id }}"
                               value="{{ question_id_answer[question.id] }}" disabled>
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">style="color: darkgreen"><font size="4" face="Arial Black">‚úÖ –í–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç: </font></label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control-plaintext"
                               name="question{{ question.id }}"
                               value="{{ question.answer }}" disabled>
                    </div>
                </div>
                {% if question_id_comment[question.id] %}
                    <div class="mb-3">
                        <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
                        {% if question_id_comment[question.id] %}
                            <textarea class="form-control-plaintext" name="comment{{ question.id }}"
                                      rows="2">{{ question_id_comment[question.id] }}</textarea>
                        {% else %}
                            <textarea class="form-control-plaintext" name="comment{{ question.id }}"
                                      rows="2"></textarea>
                        {% endif %}
                    </div>
                {% endif %}

            {% endif %}


            {#                </div>#}
        </div>
        </div>
            <!-- /–ü–µ—Ä–≤–∞—è —á–∞—Å—Ç—å -->
        {% else %}
            <!-- –í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å -->
            <div class="card mb-3">
                <h5 class="card-header">
                    {% for subject in subjects %}
                        {% if question.subject_id == subject.id %}
                            {{ subject.name }}.
                        {% endif %}
                    {% endfor %}
                    <font  color="maroon"> ‚úç –ó–∞–¥–∞–Ω–∏–µ ‚Ññ
                        {{ question.number }}</font>
                </h5>
                <div class="card-body">
                    <div>
                        <div class="mb-3">
                            <label class="form-label"><font size="3"  color="maroon">–¢–µ–∫—Å—Ç –∑–∞–¥–∞–Ω–∏—è:</font></label>
                            <div class="spaces" id="textTextAreaResult{{ question.id }}">
                                <font size="5" face="Arial"> {{ question.text }}</font>
                            </div>
                        </div>
                        <div class="mb-3">
                            {% for image in question.images %}
                                <img src="{{ url_for('static', filename= "image/uploads/" + image.source) }}"
                                     class="rounded mx-auto d-block mb-3" id="questionImage{{ image.id }}"
                                     style="max-width: 100%; max-height: 300px; min-height: 200px;">
                            {% endfor %}
                        </div>
                        <div class="mb-3">

                            {% if question_id_mark[question.id] %}
                                <div class="mb-3">
                                    <label class="form-label"><font size="3" color="#006400" face="Arial Black"> ‚úÖ –ë–∞–ª–ª:</font></label>
                                     {% if question_id_mark[question.id] %}
                                        <input type="text" class="form-control" name="mark{{ question.id }}"
                                               value="{{ question_id_mark[question.id] }}">
                                    {% else %}
                                        <input type="text" class="form-control" name="mark{{ question.id }}">
                                  {% endif %}
                                </div>
                            {% endif %}

                            {% if question_id_comment[question.id] %}
                                <div class="mb-3">
                                    <label class="form-label"><font size="3" color="#a52a2a" face="Arial Black"> üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</font></label>
                                   {% if question_id_comment[question.id] %}
                                        <textarea class="form-control" name="comment{{ question.id }}"
                                                  rows="2">{{ question_id_comment[question.id] }}</textarea>
                                    {% else %}
                                        <textarea class="form-control" name="comment{{ question.id }}"
                                                  rows="2"></textarea>
                                    {% endif %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            <!-- /–í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å -->
        {% endif %}
    {% endfor %}

    {% if comment %}
        <div class="mb-3">
            <label class="form-label">–ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
            {% if comment %}
                <textarea class="form-control-plaintext" name="comment" rows="2">{{ comment }}</textarea>
            {% else %}
                <textarea class="form-control-plaintext" name="comment" rows="2"></textarea>
            {% endif %}
        </div>
    {% endif %}


    </div>
</div>

{{ end() }}